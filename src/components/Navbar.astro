---
import logo from "../assets/logo.png";
import Container from "./ui/Container.astro";
import LanguageSwitcher from "./LanguageSwitcher.astro";
import { useTranslations } from "../i18n/utils";

interface Props {
    lang: "es" | "en";
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const navLinks = [
    { name: t("nav.services"), href: `#services` },
    { name: t("nav.work"), href: `#work` },
    { name: t("nav.about"), href: `#about` },
    { name: t("nav.contact"), href: `#contact` },
];
---

<header
    class="hidden md:block fixed top-0 left-0 right-0 z-50 transition-all duration-500 ease-in-out border-b border-white/0"
    id="navbar"
>
    <div
        id="navbar-bg"
        class="absolute inset-0 bg-transparent transition-all duration-500 ease-in-out -z-10"
    >
    </div>

    <Container>
        <div
            id="nav-container"
            class="flex items-center justify-center h-28 md:h-36 transition-all duration-500 ease-in-out relative"
        >
            <!-- Desktop Menu (Symmetric & Compact) -->
            <nav
                class="hidden md:flex items-center gap-6 lg:gap-10 justify-center"
            >
                <!-- Left Links -->
                <div class="flex items-center gap-6 lg:gap-10">
                    <a
                        href="#services"
                        class="text-[10px] uppercase tracking-[0.2em] font-bold text-gray-400 hover:text-white transition-all relative group"
                    >
                        {t("nav.services")}
                        <span
                            class="absolute -bottom-2 left-0 w-0 h-px bg-primary transition-all duration-300 group-hover:w-full"
                        ></span>
                    </a>
                    <a
                        href="#work"
                        class="text-[10px] uppercase tracking-[0.2em] font-bold text-gray-400 hover:text-white transition-all relative group"
                    >
                        {t("nav.work")}
                        <span
                            class="absolute -bottom-2 left-0 w-0 h-px bg-primary transition-all duration-300 group-hover:w-full"
                        ></span>
                    </a>
                </div>

                <!-- Logo (Centered) -->
                <div
                    class="flex-shrink-0 flex items-center justify-center mx-10 lg:mx-14"
                >
                    <a href={`/${lang}/`} class="flex items-center group">
                        <img
                            id="nav-logo"
                            src={logo.src}
                            alt="Rafael Blanco Logo"
                            class="h-20 md:h-32 w-auto object-contain transition-all duration-500 group-hover:scale-105"
                        />
                    </a>
                </div>

                <!-- Right Links -->
                <div class="flex items-center gap-6 lg:gap-10">
                    <a
                        href="#about"
                        class="text-[10px] uppercase tracking-[0.2em] font-bold text-gray-400 hover:text-white transition-all relative group"
                    >
                        {t("nav.about")}
                        <span
                            class="absolute -bottom-2 left-0 w-0 h-px bg-primary transition-all duration-300 group-hover:w-full"
                        ></span>
                    </a>
                    <a
                        href="#contact"
                        class="text-[10px] uppercase tracking-[0.2em] font-bold text-gray-400 hover:text-white transition-all relative group"
                    >
                        {t("nav.contact")}
                        <span
                            class="absolute -bottom-2 left-0 w-0 h-px bg-primary transition-all duration-300 group-hover:w-full"
                        ></span>
                    </a>
                </div>
            </nav>

            <!-- Language Switcher (Absolute Right) -->
            <div
                class="hidden md:block absolute right-4 lg:right-10 top-1/2 -translate-y-1/2 transition-all duration-300 hover:scale-110"
            >
                <LanguageSwitcher />
            </div>

            <!-- Mobile View -->
            <div
                class="flex md:hidden items-center justify-between w-full h-full"
            >
                <a href={`/${lang}/`} class="flex items-center">
                    <img
                        id="nav-logo-mobile"
                        src={logo.src}
                        alt="Logo"
                        class="h-14 w-auto object-contain"
                    />
                </a>
                <button
                    id="menu-toggle"
                    class="text-white focus:outline-none p-2 hover:bg-white/5 rounded-lg transition-colors"
                >
                    <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        class="lucide lucide-menu"
                    >
                        <line x1="4" x2="20" y1="12" y2="12"></line>
                        <line x1="4" x2="20" y1="6" y2="6"></line>
                        <line x1="4" x2="20" y1="18" y2="18"></line>
                    </svg>
                </button>
            </div>
        </div>
    </Container>

    <!-- Mobile Menu Overlay -->
    <div
        id="mobile-menu"
        class="fixed inset-0 z-40 bg-dark/98 backdrop-blur-2xl transform translate-x-full transition-transform duration-500 md:hidden flex flex-col items-center justify-center gap-10"
    >
        <button
            id="menu-close"
            class="absolute top-8 right-8 text-white p-2 hover:bg-white/5 rounded-lg transition-colors"
        >
            <svg
                xmlns="http://www.w3.org/2000/svg"
                width="28"
                height="28"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-x"
            >
                <path d="M18 6 6 18"></path>
                <path d="m6 6 12 12"></path>
            </svg>
        </button>

        <nav class="flex flex-col items-center gap-8">
            <a
                href="#services"
                class="text-3xl font-display font-black text-white hover:text-primary transition-colors mobile-link tracking-widest uppercase italic"
                >{t("nav.services")}</a
            >
            <a
                href="#work"
                class="text-3xl font-display font-black text-white hover:text-primary transition-colors mobile-link tracking-widest uppercase italic"
                >{t("nav.work")}</a
            >
            <a
                href="#about"
                class="text-3xl font-display font-black text-white hover:text-primary transition-colors mobile-link tracking-widest uppercase italic"
                >{t("nav.about")}</a
            >
            <a
                href="#contact"
                class="text-3xl font-display font-black text-white hover:text-primary transition-colors mobile-link tracking-widest uppercase italic"
                >{t("nav.contact")}</a
            >
        </nav>

        <div class="h-px w-20 bg-white/10 mt-4"></div>

        <div class="flex flex-col items-center gap-6">
            <div class="flex items-center gap-4">
                <span class="text-gray-500 text-xs uppercase tracking-widest"
                    >Idioma:</span
                >
                <LanguageSwitcher />
            </div>
        </div>
    </div>
</header>

<style>
    .glass-active {
        background-color: rgba(10, 10, 15, 0.85);
        backdrop-filter: blur(12px) saturate(180%);
        -webkit-backdrop-filter: blur(12px) saturate(180%);
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
    }
</style>

<script>
    const header = document.getElementById("navbar");
    const navbarBg = document.getElementById("navbar-bg");
    const navContainer = document.getElementById("nav-container");
    const navLogo = document.getElementById("nav-logo");
    const menuToggle = document.getElementById("menu-toggle");
    const menuClose = document.getElementById("menu-close");
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileLinks = document.querySelectorAll(".mobile-link");

    // Scroll effect
    const handleScroll = () => {
        if (!header || !navbarBg || !navContainer || !navLogo) return;

        if (window.scrollY > 20) {
            navbarBg.classList.add("glass-active");
            navContainer.classList.add("h-20");
            navContainer.classList.remove("h-28", "md:h-36");
            navLogo.classList.add("h-14", "md:h-20");
            navLogo.classList.remove("h-20", "md:h-32");
        } else {
            navbarBg.classList.remove("glass-active");
            navContainer.classList.remove("h-20");
            navContainer.classList.add("h-28", "md:h-36");
            navLogo.classList.remove("h-14", "md:h-20");
            navLogo.classList.add("h-20", "md:h-32");
        }
    };

    window.addEventListener("scroll", handleScroll);
    handleScroll();

    // Mobile menu visibility
    const toggleMenu = () => {
        mobileMenu?.classList.toggle("translate-x-full");
        document.body.classList.toggle("overflow-hidden");
    };

    menuToggle?.addEventListener("click", toggleMenu);
    menuClose?.addEventListener("click", toggleMenu);

    mobileLinks.forEach((link) => {
        link.addEventListener("click", toggleMenu);
    });
</script>
