---
import logo from "../assets/logo.png";
import Container from "./ui/Container.astro";
import Button from "./ui/Button.astro";
import { useTranslations } from "../i18n/utils";

interface Props {
    lang?: "es" | "en";
}

const { lang = "es" } = Astro.props;
const t = useTranslations(lang);
---

<section
    class="relative h-screen min-h-[700px] md:min-h-[800px] flex items-center justify-center overflow-hidden pt-4 md:pt-20 perspective-1000"
>
    <!-- Dynamic Background -->
    <div class="absolute inset-0 bg-dark">
        <div
            class="absolute inset-0 bg-[url('/grid.svg')] bg-center [mask-image:linear-gradient(180deg,white,rgba(255,255,255,0))] opacity-20"
        >
        </div>
        <div
            id="hero-glow"
            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-primary/20 rounded-full blur-[120px] mix-blend-screen transition-all duration-100 ease-out will-change-transform"
        >
        </div>
        <div
            class="absolute top-0 right-0 w-[400px] h-[400px] bg-secondary/10 rounded-full blur-[100px] animate-pulse-glow"
        >
        </div>
    </div>

    <Container className="relative z-10 text-center">
        <!-- Mobile Only Logo -->
        <div
            id="hero-logo-mobile"
            class="md:hidden flex justify-center mb-2 opacity-0 scale-95"
        >
            <div class="logo-mobile-wrapper transition-all duration-200">
                <img
                    src={logo.src}
                    alt="Rafael Blanco Logo"
                    class="h-[160px] w-auto object-contain hero-logo-float"
                />
            </div>
        </div>

        <div
            id="hero-badge"
            class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 text-sm text-secondary mb-8 opacity-0 translate-y-4"
        >
            <span class="relative flex h-2 w-2">
                <span
                    class="animate-ping absolute inline-flex h-full w-full rounded-full bg-secondary opacity-75"
                ></span>
                <span
                    class="relative inline-flex rounded-full h-2 w-2 bg-secondary"
                ></span>
            </span>
            {t("hero.badge")}
        </div>

        <h1
            class="text-4xl sm:text-5xl md:text-7xl lg:text-8xl font-bold font-display tracking-tighter mb-8 leading-tight"
        >
            <span
                class="hero-text-line block bg-clip-text text-transparent bg-gradient-to-b from-white via-white to-white/50 opacity-0 translate-y-8"
            >
                {t("hero.title.base")}
            </span>
            <span
                class="hero-text-line block text-transparent bg-clip-text bg-gradient-to-r from-primary via-secondary to-primary bg-[length:200%_auto] animate-gradient opacity-0 translate-y-8"
            >
                {t("hero.title.highlight")}
            </span>
        </h1>

        <p
            id="hero-desc"
            class="text-base md:text-2xl text-gray-400 max-w-2xl mx-auto mb-12 leading-relaxed opacity-0 translate-y-4 px-4 md:px-0"
        >
            {t("hero.desc")}
        </p>

        <div
            id="hero-cta"
            class="flex flex-col sm:flex-row items-center justify-center gap-6 opacity-0 translate-y-4 px-6 md:px-0"
        >
            <Button
                href="#contact"
                variant="primary"
                size="lg"
                className="w-full sm:w-auto shadow-[0_0_40px_rgba(112,0,255,0.3)] hover:shadow-[0_0_60px_rgba(112,0,255,0.5)]"
            >
                {t("hero.cta.primary")}
            </Button>
            <Button
                href="#work"
                variant="secondary"
                size="lg"
                className="w-full sm:w-auto"
            >
                {t("hero.cta.secondary")}
            </Button>
        </div>
    </Container>

    <!-- Scroll Indicator (Hidden on Mobile) -->
    <div
        id="scroll-indicator"
        class="hidden md:flex absolute bottom-12 left-1/2 -translate-x-1/2 opacity-0"
    >
        <div
            class="w-6 h-10 rounded-full border-2 border-white/20 flex items-start justify-center p-1"
        >
            <div class="w-1 h-2 bg-white/50 rounded-full animate-scroll-hint">
            </div>
        </div>
    </div>
</section>

<style>
    .perspective-1000 {
        perspective: 1000px;
    }
    .text-glow-lg {
        text-shadow: 0 0 30px rgba(112, 0, 255, 0.3);
    }

    /* Mobile Logo Animations */
    @media (max-width: 767px) {
        .hero-logo-float {
            animation: float 4s ease-in-out infinite;
            filter: drop-shadow(0 0 10px rgba(112, 0, 255, 0.15));
        }

        .logo-mobile-wrapper:active {
            transform: scale(1.1);
            filter: drop-shadow(0 0 25px rgba(112, 0, 255, 0.6));
        }
    }

    @keyframes float {
        0% {
            transform: translateY(0px);
        }
        50% {
            transform: translateY(-8px);
        }
        100% {
            transform: translateY(0px);
        }
    }
</style>

<script>
    import { gsap } from "gsap";

    // Hero Entrance Animation
    const tl = gsap.timeline({ defaults: { ease: "power3.out" } });

    // Initial check to animate mobile logo if visible
    if (window.innerWidth < 768) {
        tl.to("#hero-logo-mobile", {
            opacity: 1,
            scale: 1,
            duration: 1,
            delay: 0.3,
        });
    }

    tl.to("#hero-badge", { opacity: 1, y: 0, duration: 1 }, "-=0.5")
        .to(
            ".hero-text-line",
            { opacity: 1, y: 0, duration: 1.2, stagger: 0.2 },
            "-=0.7",
        )
        .to("#hero-desc", { opacity: 1, y: 0, duration: 1 }, "-=0.8")
        .to("#hero-cta", { opacity: 1, y: 0, duration: 1 }, "-=0.8");

    // Desktop only scroll indicator animation
    if (window.innerWidth >= 768) {
        tl.to("#scroll-indicator", { opacity: 1, duration: 1 }, "-=0.5");
    }

    // Mouse Parallax & Glow (Desktop Only for performance)
    const section = document.querySelector("section");
    const glow = document.getElementById("hero-glow");

    if (section && glow && window.innerWidth >= 1024) {
        section.addEventListener("mousemove", (e) => {
            const { clientX, clientY } = e;
            const x = (clientX / window.innerWidth - 0.5) * 2;
            const y = (clientY / window.innerHeight - 0.5) * 2;

            // Move glow opposite to mouse for depth
            gsap.to(glow, {
                x: -x * 50,
                y: -y * 50,
                duration: 1.5,
                ease: "power2.out",
            });

            // Tilt text slightly
            gsap.to(".hero-text-line", {
                x: x * 20,
                y: y * 20,
                rotationX: -y * 5,
                rotationY: x * 5,
                duration: 2,
                ease: "power2.out",
            });
        });
    }
</script>
