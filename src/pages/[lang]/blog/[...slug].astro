---
import { getCollection } from "astro:content";
import Layout from "../../../layouts/Layout.astro";
import Navbar from "../../../components/Navbar.astro";
import Footer from "../../../components/Footer.astro";
import Container from "../../../components/ui/Container.astro";

export async function getStaticPaths() {
    const posts = await getCollection("blog");

    const paths = posts.map((post) => {
        return {
            params: {
                lang: post.data.lang,
                slug: post.slug,
            },
            props: post,
        };
    });

    return paths;
}

const post = Astro.props;
const { Content } = await post.render();
const lang = post.data.lang as "es" | "en";
---

<Layout title={`${post.data.title} | Novatlas`} lang={lang}>
    <Navbar lang={lang} />

    <main class="pt-32 pb-20">
        <article>
            <div class="relative w-full h-[50vh] min-h-[400px] mb-12">
                <div
                    class="absolute inset-0 bg-gradient-to-t from-dark to-transparent z-10"
                >
                </div>
                <img
                    src={post.data.heroImage}
                    alt={post.data.title}
                    class="w-full h-full object-cover"
                />

                <Container
                    className="absolute bottom-0 left-1/2 -translate-x-1/2 z-20 pb-12 w-full"
                >
                    <div class="max-w-4xl mx-auto">
                        <div
                            class="inline-block px-3 py-1 bg-primary/20 border border-primary/50 rounded-full text-primary text-sm font-bold mb-6 backdrop-blur-md"
                        >
                            {
                                post.data.pubDate.toLocaleDateString(lang, {
                                    year: "numeric",
                                    month: "long",
                                    day: "numeric",
                                })
                            }
                        </div>
                        <h1
                            class="text-4xl md:text-6xl font-bold font-display leading-tight"
                        >
                            {post.data.title}
                        </h1>
                    </div>
                </Container>
            </div>

            <Container className="max-w-3xl">
                <div
                    class="prose prose-invert prose-lg prose-headings:font-display prose-a:text-primary hover:prose-a:text-secondary max-w-none"
                >
                    <Content />
                </div>
            </Container>
        </article>
    </main>

    <Footer lang={lang} />
</Layout>
